import { defineConfig, UserConfig, PluginOption } from "vite";
import solidPlugin from "vite-plugin-solid";
import tsconfigPaths from "vite-tsconfig-paths";
import mdx from "@mdx-js/rollup";
import { mdxConfig } from "./mdx.config";

async function getConfig(): Promise<UserConfig> {
  const plugins: PluginOption[] = [
    tsconfigPaths(),
    { ...mdx(mdxConfig), enforce: "pre" },
    solidPlugin({ extensions: [".mdx", ".md"] }),
  ];
  return {
    plugins,
    server: {
      port: 3000,
    },
    build: {
      target: "esnext",
    }
  };
}
export default defineConfig(getConfig);
